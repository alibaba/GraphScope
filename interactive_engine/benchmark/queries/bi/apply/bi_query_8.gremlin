g.V().has("TAG", "name", "$tag").union(__.in("HASINTEREST"),__.in("HASTAG").has("creationDate", P.gt($startDate).and(P.lt($endDate))).out("HASCREATOR")).dedup().as("person").select("person").by(out("HASINTEREST").has("TAG", "name", "$tag").count()).as("cnt1").select("person").by(__.in("HASCREATOR").has("creationDate", P.gt($startDate).and(P.lt($endDate))).out("HASTAG").has("TAG", "name", "$tag").count()).as("cnt2").select("person").by(both("KNOWS").out("HASINTEREST").has("TAG", "name", "$tag").count()).as("fCnt1").select("person").by(both("KNOWS").in("HASCREATOR").has("creationDate", P.gt($startDate).and(P.lt($endDate))).out("HASTAG").has("TAG", "name", "$tag").count()).as("fCnt2").select(expr("(@cnt1 + @fCnt1) * 100 + (@cnt2 + @fCnt2)")).as("total").order().by(select("total"), desc).by(select("person").by("id"), asc).limit(100).select("person", "total").by("id").by()