g.V().has("TAG", "name", "$tag").in("HASTAG").dedup().as("msg").out("HASCREATOR").dedup().as("person").select("person").by(__.in("HASCREATOR").out("HASTAG").has("TAG", "name", "$tag").dedup().count()).as("msgCnt").select("person").by(__.in("HASCREATOR").as("msg").out("HASTAG").has("TAG", "name", "$tag").select("msg").in("LIKES").dedup().count()).as("likeCnt").select("person").by(__.in("HASCREATOR").as("msg").out("HASTAG").has("TAG", "name", "$tag").select("msg").in("REPLYOF").dedup().count()).as("replyCnt").select(expr("1 * @msgCnt + 2 * @replyCnt + 10 * @likeCnt")).as("score").order().by(select("score"), desc).by(select("person").values("id"), asc).limit(100).select("person", "replyCnt", "likens", "msgCnt", "score").by("id").by().by().by().by()