g.V().has("TAGCLASS", "name", "$tagClass").in("HASTYPE").as("tag").select("tag").by(__.in("HASTAG").hasLabel("POST", "COMMENT").has("creationDate", P.gte($date).and(P.lt($ddate))).dedup().count()).as("cnt1").select("tag").by(__.in("HASTAG").hasLabel("POST", "COMMENT").has("creationDate", P.gte($ddate).and(P.lt($dddate))).dedup().count()).as("cnt2").select(expr("(@cnt2 - @cnt1)*(@cnt2 - @cnt1)")).as("diff").order().by(select("diff"), desc).by(select("tag").by("name"), asc).limit(100).select("tag", "cnt1", "cnt2", "diff").by("name").by().by().by()