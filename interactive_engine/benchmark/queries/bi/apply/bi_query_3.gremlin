g.V().has("COUNTRY", "name", "$country").in("ISPARTOF").in("ISLOCATEDIN").as("person").in("HASMODERATOR").as("forum").select("forum").by(out("CONTAINEROF").in("0..6", "REPLYOF").endV().as("msg").out("HASTAG").out("HASTYPE").has("TAGCLASS", "name", "$tagClass").select("msg").dedup().count()).as("msgCnt").order().by(select("msgCnt"), desc).by(select("forum").by("id"), asc).limit(20).select("forum", "person", "msgCnt").by(valueMap("id", "title", "creationDate")).by("id").by()