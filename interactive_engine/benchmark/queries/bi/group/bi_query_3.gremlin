g.V().has("COUNTRY", "name", "$country").in("ISPARTOF").in("ISLOCATEDIN").as("person").in("HASMODERATOR").as("forum") .out("CONTAINEROF").in("0..5", "REPLYOF").endV().as("msg").out("HASTAG").out("HASTYPE").has("TAGCLASS", "name", "$tagClass").select("msg").group().by(select("forum").as("forum")).by(dedup().count().as("msgCnt")).order().by(select("msgCnt"), desc).by(select("forum").by("id"), asc).limit(20).select("forum", "msgCnt").by(valueMap("id", "title", "creationDate")).by()