g.V().has("TAG", "name", "$tag").union(    __.in("HASINTEREST").as("interest"),     __.in("HASTAG").has("creationDate", P.gt($startDate).and(P.lt($endDate))).as("msg").out("HASCREATOR")).group().by().by(    select("interest").count().as("cnt1"),    select("msg").count().as("cnt2")).select(keys).as("person").select(expr("100 * @cnt1 + @cnt2")).as("score").select("person").both("KNOWS").as("friends").union(    __.out("HASINTEREST").has("TAG", "name", "$tag").as("fInterest"),    __.in("HASCREATOR").has("creationDate", P.gt($startDate).and(P.lt($endDate))).as("fMsg").out("HASTAG").has("TAG", "name", "$startDate")).group().by(select("person").as("person"), select("score").as("score")).by(    select("fInterest").count().as("fCnt1"),    select("fMsg").count().as("fCnt2")).select(expr("100 * @fCnt1 + @fCnt2")).as("fScore").select(expr("@score + @fScore")).as("total").order().by(select("total"), desc).by(select("person").by("id"), asc).limit(100).select("person", "total").by("id").by()