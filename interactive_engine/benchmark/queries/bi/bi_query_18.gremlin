g.V().has("TAG", "name", "$tag").as("tag").in("HASINTEREST").as("p1").both("KNOWS").as("mutual").both("KNOWS").where(P.neq("p1")).as("p2").out("HASINTEREST").where(P.eq("tag")).not(select("p1").both("KNOWS").where(P.eq("p2"))).select(expr("@p1.id")).as("p1_id").select(expr("@p2.id")).as("p2_id").select("mutual").groupCount().by(select("p1_id"), select("p2_id")).select(values).order().by(desc).limit(20)