g.V().hasLabel('PERSON').has('id',$personId).union(both('KNOWS'), both('KNOWS').both('KNOWS')).dedup().where(__.out('ISLOCATEDIN').has('name',without('$countryXName','$countryYName'))).where(__.in('HASCREATOR').has('creationDate',gt($startDate).and(lt($endDate))).out('ISLOCATEDIN').has('name', eq('$countryXName').or(eq('$countryYName'))).values("name").dedup().count().is(2)).order().by(__.in('HASCREATOR').has('creationDate',gt($startDate).and(lt($endDate))).out('ISLOCATEDIN').has('name', '$countryXName').count(), desc).by('id',asc).limit(20)