g.V().hasLabel('person').has('id',$personId).out('knows').as('friend').in('hasCreator').hasLabel('comment').where(out('replyOf').hasLabel('post').out('hasTag').out('hasType').has('name',eq('$tagClassName'))).select('friend').groupCount().order().by(select(values), desc).by(select(keys).values('id'), asc).limit(20)