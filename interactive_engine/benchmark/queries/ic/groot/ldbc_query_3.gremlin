g.V().hasLabel('person').has('id',$personId).out('1..3','knows').inV().dedup().where(__.out('isLocatedIn').has('name',without('$countryXName','$countryYName'))).where(__.in('hasCreator').has('creationDate',gt($startDate).and(lt($endDate))).out('isLocatedIn').has('name', eq('$countryXName').or(eq('$countryYName'))).values("name").dedup().count().is(2)).order().by(__.in('hasCreator').has('creationDate',gt($startDate).and(lt($endDate))).out('isLocatedIn').has('name', '$countryXName').count(), desc).by('id',asc).limit(20)