g.V($personId).as('person').out("knows").in("hasCreator").hasLabel("post").as('post').has("creationDate", gte($startDate).and(lt($endDate))).out("hasTag").as('tag').select("person").not(out("knows").in("hasCreator").hasLabel("post").has("creationDate", lt($startDate)).out("hasTag").where(eq('tag'))).select("tag").groupCount().order().by(select(values), Order.desc).by(select(keys).values('name'), Order.asc).limit(10).as("ordered").select(keys).values("name").as("tagName").select("ordered").select(values).as("postCount").select("tagName","postCount")