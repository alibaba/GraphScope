g.V($personId).both('1..3','KNOWS').inV().dedup().where(__.out('ISLOCATEDIN').has('name',without('$countryXName','$countryYName'))).where(__.in('HASCREATOR').has('creationDate',gt($startDate).and(lt($endDate))).out('ISLOCATEDIN').has('name', eq('$countryXName').or(eq('$countryYName'))).values("name").dedup().count().is(2)).order().by(__.in('HASCREATOR').has('creationDate',gt($startDate).and(lt($endDate))).out('ISLOCATEDIN').has('name', '$countryXName').count(), desc).by('id',asc).limit(20)