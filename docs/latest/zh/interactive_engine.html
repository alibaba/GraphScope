<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>图交互式分析引擎 &mdash; GraphScope  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="图学习引擎" href="learning_engine.html" />
    <link rel="prev" title="图分析引擎" href="analytics_engine.html" />

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4TMYCGJ0X2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4TMYCGJ0X2');
</script>

<script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?da649ade2298891886e31922dfc8870f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GraphScope
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div>
  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      
      
        
          
        
      
      
        <p class="caption"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">快速上手</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">部署</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">入门教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="loading_graph.html">载图</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_transformation.html">图的变换操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="analytics_engine.html">图分析引擎</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">图交互式分析引擎</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#apache-tinkerpop">Apache TinkerPop</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-gremlin-graphscope">利用Python（Gremlin）连接GraphScope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#java-gremlin-graphscope">利用Java（Gremlin）连接GraphScope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">Gremlin Console（开发控制台）</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gremlin-101">Gremlin编程入门–101</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">图数据模型</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">查询语言</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">一个例子</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gremlin-tinkerpop">Gremlin兼容性（对比TinkerPop）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">属性图模型约束</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">尚不支持的功能特性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">支持的Gremlin操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">已知限制</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="learning_engine.html">图学习引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="frequently_asked_questions.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">开发者指南</a></li>
</ul>
<p class="caption"><span class="caption-text">API 参考</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://graphscope.io/docs/reference/python_index.html">Python API 参考</a></li>
<li class="toctree-l1"><a class="reference external" href="https://graphscope.io/docs/reference/analytical_engine_index.html">图分析引擎 API 参考</a></li>
</ul>

      
    
  </div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GraphScope</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">GraphScope: 一站式图计算系统</a> &raquo;</li>
      <li>图交互式分析引擎</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/alibaba/graphscope/edit/main/docs/zh/interactive_engine.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="id1">
<h1>图交互式分析引擎<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h1>
<p>GraphScope的交互查询引擎（简称GIE）是一个分布式系统，它为不同经验的用户提供了一个易用的交互式环境，支持海量复杂图数据上的 <em>实时分析与交互探索</em> 。该引擎支持 <a class="reference external" href="http://tinkerpop.apache.org/">Gremlin</a> 语言表达的交互图查询，并提供了自动化和用户透明的分布式并行执行。</p>
<div class="section" id="apache-tinkerpop">
<h2>Apache TinkerPop<a class="headerlink" href="#apache-tinkerpop" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="http://tinkerpop.apache.org/">Apache TinkerPop</a> 是基于Gremlin语言开发交互式图应用的一个开源框架和事实标准。GIE通过TinkerPop提供的 <a class="reference external" href="https://tinkerpop.apache.org/docs/current/reference/#gremlin-server">Gremlin Server</a> 接口，实现了与TinkerPop生态无缝集成，从而用户可以直接采用诸如 <a class="reference external" href="https://tinkerpop.apache.org/docs/current/reference/#gremlin-console">Gremlin Console</a> 的开发工具或通过Java和Python等多种语言接口编写应用逻辑。</p>
</div>
<div class="section" id="python-gremlin-graphscope">
<h2>利用Python（Gremlin）连接GraphScope<a class="headerlink" href="#python-gremlin-graphscope" title="Permalink to this headline"></a></h2>
<p>如下所示，用户可以很简单的通过Python连上一个载入GraphScope系统的图并发起Gremlin查询。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">graphscope</span>
<span class="kn">from</span> <span class="nn">graphscope.dataset</span> <span class="kn">import</span> <span class="n">load_ldbc</span>

<span class="c1"># 创建一个新的交互会话，载入LDBC示例图数据</span>
<span class="c1"># 随后返回一个Gremlin查询提交入口</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">graphscope</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">load_ldbc</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/path/to/ldbc_sample&#39;</span><span class="p">)</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">gremlin</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

<span class="c1"># 下面两句Gremlin示例查询分别计算图中顶点和边的总数</span>
<span class="n">node_num</span> <span class="o">=</span> <span class="n">interactive</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;g.V().count()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="n">edge_num</span> <span class="o">=</span> <span class="n">interactive</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;g.E().count()&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</pre></div>
</div>
<p>上面代码中的 <code class="docutils literal notranslate"><span class="pre">interactive</span></code> 对象事实上是Python类 <code class="docutils literal notranslate"><span class="pre">InteractiveQuery</span></code> 的一个实例，而这一类封装了用Python实现的完整Gremlin客户端类库 <a class="reference external" href="https://pypi.org/project/gremlinpython/">Gremlin-Python</a> 。</p>
<p>每一个载入GraphScope的图都包含一个Gremlin查询提交入口，可以像下面这样获得具体的访问地址（URL）:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">interactive</span><span class="o">.</span><span class="n">graph_url</span><span class="p">)</span>
</pre></div>
</div>
<p>上面的语句会产生如下（格式）的输出：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="p">:</span><span class="o">//</span><span class="n">your</span><span class="o">-</span><span class="n">endpoint</span><span class="p">:</span><span class="n">your</span><span class="o">-</span><span class="n">ip</span><span class="o">/</span><span class="n">gremlin</span>
</pre></div>
</div>
<p>有了这一URL信息，用户也可以直接采用Gremlin-Python访问图数据，具体可以参考 <a class="reference external" href="https://tinkerpop.apache.org/docs/current/reference/#gremlin-python">官方文档</a> 。</p>
</div>
<div class="section" id="java-gremlin-graphscope">
<h2>利用Java（Gremlin）连接GraphScope<a class="headerlink" href="#java-gremlin-graphscope" title="Permalink to this headline"></a></h2>
<p>TinkerPop同时支持Java语言按类似方式访问，详见Gremlin-Java的 <a class="reference external" href="https://tinkerpop.apache.org/docs/current/reference/#gremlin-java">官方文档</a> 。</p>
</div>
<div class="section" id="id5">
<h2>Gremlin Console（开发控制台）<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://tinkerpop.apache.org/docs/current/tutorials/the-gremlin-console/">Gremlin Console</a> 为开发者提供了一个与GraphScope存储的图数据进行交互的控制台，也叫做REPL环境（read-evaluate-print loop）。下面描述如何利用上文获得的URL，安装和配置Gremlin Console以连接GraphScope的步骤：</p>
<p>1.安装Gremlin Console依赖的Java运行时环境，版本需要满足[8, 12)。</p>
<p>2.从 <a class="reference external" href="https://tinkerpop.apache.org/downloads.html">Apache TinkerPop</a> 下载适当版本的Gremlin Console。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://archive.apache.org/dist/tinkerpop/3.4.8/apache-tinkerpop-gremlin-console-3.4.8-bin.zip
</pre></div>
</div>
<p>3.解压缩下载的文件。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unzip apache-tinkerpop-gremlin-console-3.4.8-bin.zip
</pre></div>
</div>
<p>4.进入解压缩的目录。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> apache-tinkerpop-gremlin-console-3.4.8
</pre></div>
</div>
<p>5.在 <cite>conf</cite> 子目录创建一个名为 <cite>graphscope-remote.yaml</cite> 的文本文件以配置URL。具体内容如下所示，其中的 <em>your-endpoint</em> 和 <em>your-port</em> 需要分别替换为从GraphScope会话得到的URL中对应的主机名（或IP）和端口。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hosts</span><span class="p">:</span> <span class="p">[</span><span class="n">your</span><span class="o">-</span><span class="n">endpoint</span><span class="p">]</span>
<span class="n">port</span><span class="p">:</span> <span class="n">your</span><span class="o">-</span><span class="n">port</span>
<span class="n">serializer</span><span class="p">:</span> <span class="p">{</span> <span class="n">className</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">tinkerpop</span><span class="o">.</span><span class="n">gremlin</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">GryoMessageSerializerV1d0</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="p">{</span> <span class="n">serializeResultToString</span><span class="p">:</span> <span class="n">true</span> <span class="p">}}</span>
</pre></div>
</div>
<p>6.输入下列命令启动Gremlin Console。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bin/gremlin.sh
</pre></div>
</div>
<p>7.在 <cite>gremlin&gt;</cite> 提示符下，输入下列命令连接到对应的GraphScope会话；第二条命令切换到远程模式，从而接下来输入的所有Gremlin查询都被自动传输到（远程）GraphScope执行。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>:remote connect tinkerpop.server conf/graphscope-remote.yaml
:remote console
</pre></div>
</div>
<p>8.现在你可以尝试一些简单的Gremlin查询了！例如 <code class="docutils literal notranslate"><span class="pre">g.V().limit(1)</span></code> 。当你完成交互，输入下列命令可以退出Gremlin Console。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>:exit
</pre></div>
</div>
</div>
<div class="section" id="gremlin-101">
<h2>Gremlin编程入门–101<a class="headerlink" href="#gremlin-101" title="Permalink to this headline"></a></h2>
<p>GIE以忠实保留Gremlin编程模型为设计目标，从而让已有的应用只需最小化的修改就可以扩展到大规模计算集群。在此我们提供一个Gremlin的总体介绍，特别是其中包含的图数据模型和查询语言等关键概念。更详细和完整的介绍，请参考 <a class="reference external" href="https://tinkerpop.apache.org/docs/current/reference/">TinkerPop reference</a> 。</p>
<div class="section" id="id8">
<h3>图数据模型<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h3>
<p>Gremlin允许用户在属性图模型上定义特设（ad-hoc）遍历查询。一个属性图是一个有向图，其中的顶点和边可以拥有一组属性。图中的每个对象（点或边）都有一个唯一标识（<code class="docutils literal notranslate"><span class="pre">ID</span></code>）和一个类别名称（<code class="docutils literal notranslate"><span class="pre">label</span></code>）指定其类型或角色。每个属性是一个包含属性名和属性值的（键-值）对，其所属对象的 <code class="docutils literal notranslate"><span class="pre">ID</span></code> 加上属性名可以唯一确定属性值。</p>
<a class="reference internal image-reference" href="../_images/property_graph.png"><img alt="电商属性图模型示例。" class="align-center" src="../_images/property_graph.png" style="width: 400px;" /></a>
<p>上图展示了一个属性图模型示例。它包含 <code class="docutils literal notranslate"><span class="pre">user</span></code> （用户）、 <code class="docutils literal notranslate"><span class="pre">product</span></code> （商品）和 <code class="docutils literal notranslate"><span class="pre">address</span></code> （地址）三类点，它们通过 <code class="docutils literal notranslate"><span class="pre">order</span></code> （购买）、 <code class="docutils literal notranslate"><span class="pre">deliver</span></code> （递送）、 <code class="docutils literal notranslate"><span class="pre">belongs_to</span></code> （属于）和 <code class="docutils literal notranslate"><span class="pre">home_of</span></code> （家庭地址）四类边相互关联。图中虚线展示的一条（从起点到终点的）路径1–&gt;2–&gt;3，代表了一个用户（买家）”Tom”购买了一个卖家”Jack”提供的标价”$99”的商品”gift”。</p>
</div>
<div class="section" id="id9">
<h3>查询语言<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h3>
<p>一个Gremlin查询或图遍历的执行，可以用一组 <em>遍历器</em> （traversers）标识。它们依据Gremlin查询提供的用户指令在输入图中游走，最终所有停止的遍历器集合（包含它们的位置）代表了查询的结果。一个遍历器是Gremlin引擎处理的最小数据单元。每个遍历器都维护它对应的图中的当前位置，可以是被访问的点、边或属性。同时，可选的它也可以包含走过的完整路径历史甚至应用状态。</p>
<p>Gremlin语言丰富灵活的表达能力主要来自于它对 <em>嵌套遍历</em> 的支持，它允许一个（子）查询或遍历被包含在另一个操作中，作为一个可调用的函数被包裹操作用于处理其每一个输入。函数的声明和作用都由包裹操作的语义决定。</p>
<p>例如， <code class="docutils literal notranslate"><span class="pre">where</span></code> （过滤）操作可以包含一个嵌套查询，作为过滤条件谓词。而 <code class="docutils literal notranslate"><span class="pre">select</span></code> （映射）或 <code class="docutils literal notranslate"><span class="pre">order</span></code> （排序）操作各自可以通过嵌套查询讲每一个输入单独映射到从它开始的子遍历得到的结果，或依据结果值作为排序依据。</p>
<p>嵌套遍历的另一个重要应用是表达循环，在Gremlin中通过 <code class="docutils literal notranslate"><span class="pre">repeat</span></code> （循环）操作和随后的 <code class="docutils literal notranslate"><span class="pre">until/times</span></code> （终止条件）表达。 <code class="docutils literal notranslate"><span class="pre">repeat</span></code> 操作包含一个嵌套遍历作为循环体，每一个输入都会重复送入这一子查询，直到终止条件满足。 <code class="docutils literal notranslate"><span class="pre">until</span></code> （条件终止）操作类似 <code class="docutils literal notranslate"><span class="pre">where</span></code> ，可以表达一个条件谓词，它被独立应用于循环体的每一个输出遍历器，满足条件的遍历器就会离开循环。另一个常用的 <code class="docutils literal notranslate"><span class="pre">times</span></code> （迭代轮次终止）操作可以利用一个整型常量 <code class="docutils literal notranslate"><span class="pre">k</span></code> 表达固定迭代轮次后终止循环。</p>
</div>
<div class="section" id="id10">
<h3>一个例子<a class="headerlink" href="#id10" title="Permalink to this headline"></a></h3>
<p>下面展示了一个完整的Gremlin示例，它尝试从一个给定账户（account）点开始找到长度为 <code class="docutils literal notranslate"><span class="pre">k</span></code> 的有向环路。</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span>g.V(&#39;account&#39;).has(&#39;id&#39;,&#39;2&#39;).as(&#39;s&#39;)
 .out(&#39;k-1..k&#39;, &#39;transfer&#39;)
 .with(&#39;PATH_OPT&#39;, &#39;SIMPLE&#39;)
 .endV()
 .where(out(&#39;transfer&#39;).eq(&#39;s&#39;))
 .path().limit(1)
</pre></div>
</div>
<p>首先，输入图操作 <code class="docutils literal notranslate"><span class="pre">V</span></code> （包含一个 <code class="docutils literal notranslate"><span class="pre">has</span></code> 表达的简单过滤）返回图中满足条件的 <code class="docutils literal notranslate"><span class="pre">account</span></code> 点（即唯一标识为 <code class="docutils literal notranslate"><span class="pre">2</span></code> 的点）。紧随其后的 <code class="docutils literal notranslate"><span class="pre">as</span></code> 操作是一个 <em>修饰符</em> ，它不改变输入遍历器集合，但对其中每一个遍历器的当前位置，打上一个有名标签（这个例子中的 <code class="docutils literal notranslate"><span class="pre">s</span></code> ），从而今后可以引用。接下来，查询沿着 <code class="docutils literal notranslate"><span class="pre">transfer</span></code> 类型的出边循环游走 <code class="docutils literal notranslate"><span class="pre">k-1</span></code> 次（输出hops在[k-1, k)范围内的邻点），且每一次都过滤或跳过路径中的重复点（通过在 <code class="docutils literal notranslate"><span class="pre">with</span></code> 内配置 <code class="docutils literal notranslate"><span class="pre">SIMPLE</span></code> 选项实现）。最后， <code class="docutils literal notranslate"><span class="pre">where</span></code> 操作检查此时遍历路径的下一跳是否可以回到起点（用 <code class="docutils literal notranslate"><span class="pre">s</span></code> 指代），从而形成一个长度为 <code class="docutils literal notranslate"><span class="pre">k</span></code> 的环。对于检测到的环，查询还通过 <code class="docutils literal notranslate"><span class="pre">path</span></code> 操作展示每个遍历器的完成路径信息。 <code class="docutils literal notranslate"><span class="pre">limit</span></code> 操作类似SQL中的top K，它表达了查询结果仅需要包含一个这样的路径（如果有的话）。</p>
</div>
</div>
<div class="section" id="gremlin-tinkerpop">
<h2>Gremlin兼容性（对比TinkerPop）<a class="headerlink" href="#gremlin-tinkerpop" title="Permalink to this headline"></a></h2>
<p>GIE支持Apache TinkerPop定义的属性图模型和Gremlin遍历查询，且实现了一个与TinkerPop 3.3和3.4版本兼容的 <em>Websockets</em> 服务接口。除此之外，我们扩展了一些语法糖来进一步引入一些简洁明了的expression表示。下面我们列出当前实现和Apache TinkerPop规范的主要差一点（其中一些差异会有机会消除、另一些是目前GraphScope定位的场景差异造成的不同设计选择）。</p>
<div class="section" id="id11">
<h3>属性图模型约束<a class="headerlink" href="#id11" title="Permalink to this headline"></a></h3>
<p>目前的MaxGraph技术预览版利用了 <a class="reference external" href="https://github.com/v6d-io/v6d">Vineyard</a> 项目提供的分布式内存存储作为输入图，它支持一次载入 <em>不可修改</em> 的图模型数据，和图分片存储在分布式集群。当前设计有下面的一些限制：</p>
<ul class="simple">
<li><p>Schema（模式）约束：每个图的数据需要满足事先定义的Schema，包括点、边的类型名称（label）和属性名及值类型。</p></li>
<li><p>主键约束：每个顶点类型需要包含一个用户可自定义的主键（属性），同时系统会为每个点和边对象，自动分配产生一个字符串类型的唯一标识（ID）。对于点来说，ID编码了类型（label）和用户自定义主键信息。</p></li>
<li><p>每个点或边的属性，可以包含下列类型的属性值：<code class="docutils literal notranslate"><span class="pre">int</span></code>、<code class="docutils literal notranslate"><span class="pre">long</span></code>、<code class="docutils literal notranslate"><span class="pre">float</span></code>、<code class="docutils literal notranslate"><span class="pre">double</span></code>、<code class="docutils literal notranslate"><span class="pre">String</span></code>、<code class="docutils literal notranslate"><span class="pre">List&lt;int&gt;</span></code>、<code class="docutils literal notranslate"><span class="pre">List&lt;long&gt;</span></code> 和 <code class="docutils literal notranslate"><span class="pre">List&lt;String&gt;</span></code> 。</p></li>
</ul>
</div>
<div class="section" id="id12">
<h3>尚不支持的功能特性<a class="headerlink" href="#id12" title="Permalink to this headline"></a></h3>
<p>因为系统的全分布式可扩展架构，当前定位的场景和实现不支持下列功能：</p>
<ul class="simple">
<li><p>图修改操作。</p></li>
<li><p>Lambda和Groovy表达式或自定义函数，例如：<code class="docutils literal notranslate"><span class="pre">.map{&lt;expression&gt;}</span></code>、<code class="docutils literal notranslate"><span class="pre">.by{&lt;expression&gt;}</span></code> 和 <code class="docutils literal notranslate"><span class="pre">.filter{&lt;expression&gt;}</span></code> 函数，<code class="docutils literal notranslate"><span class="pre">1+1</span></code> 和 <code class="docutils literal notranslate"><span class="pre">System.currentTimeMillis()</span></code> 等表达式或Java调用等等。</p></li>
<li><p>定制Gremlin图遍历策略（traversal strategies），即查询优化由GraphScope系统自动完成。</p></li>
<li><p>事务。</p></li>
<li><p>二级索引目前尚未支持（用户定义的主键会被自动索引）。</p></li>
</ul>
</div>
<div class="section" id="id13">
<h3>支持的Gremlin操作<a class="headerlink" href="#id13" title="Permalink to this headline"></a></h3>
<p>当前GraphScope支持下列Gremlin操作（和示例用法）：</p>
<ul class="simple">
<li><p>Source（输入图），如：</p></li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//V</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">()</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span><span class="w"> </span><span class="n">id2</span><span class="p">)</span><span class="w"></span>

<span class="c1">//E</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">E</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>Filter（过滤），如：</p></li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span>//hasLabel
g.V().hasLabel(&quot;labelName&quot;)
g.V().hasLabel(&quot;labelName1&quot;, &quot;labelName2&quot;)

//has
g.V().has(&quot;attrName&quot;)
g.V().has(&quot;attrName&quot;, attrValue)
g.V().has(&quot;labelName&quot;, &quot;attrName&quot;, attrValue)
g.V().has(&quot;attrName&quot;, eq(1))
g.V().has(&quot;attrName&quot;, neq(1))
g.V().has(&quot;attrName&quot;, lt(1))
g.V().has(&quot;attrName&quot;, lte(1))
g.V().has(&quot;attrName&quot;, gt(1))
g.V().has(&quot;attrName&quot;, gte(1))
g.V().has(&quot;attrName&quot;, within([1,2,3]))
g.V().has(&quot;attrName&quot;, without([1,2,3]))
g.V().has(&quot;attrName&quot;, inside(10, 20))
g.V().has(&quot;attrName&quot;, outside(10, 20))

// P.not
g.V().has(&quot;attrName&quot;, P.not(eq(10)))

//is
g.V().values(&quot;age&quot;).is(gt(70))

//通过expression实现过滤 (`expr()` 语法糖)
g.V().where(expr(&#39;@.age &gt; 20&#39;)) //@.age 代表head节点的age属性
g.V().as(&#39;a&#39;).out().as(&#39;b&#39;).where(expr(&#39;@a.age &lt;= @b.age&#39;))  //@a.age 代表 &quot;a&quot; 节点的age属性
g.V().where(expr(&#39;30 within @.a&#39;))  //head节点的a属性是整数数组类型
//project with expression (`expr()` 语法糖)
g.V().select(expr(&quot;@.age&quot;)) //@.age 代表head节点的age属性

//通过expression实现位运算
g.V().select(expr(&quot;@.number &amp; 2&quot;)) //head节点的number属性是整型
g.V().select(expr(&quot;@.number | 2&quot;))
g.V().select(expr(&quot;@.number ^ 2&quot;))
g.V().select(expr(&quot;@.number &lt;&lt; 2&quot;))
g.V().select(expr(&quot;@.number &gt;&gt; 2&quot;))
g.V().where(expr(&quot;@.number &amp; 64 != 0&quot;))

//通过expression实现算数运算
g.V().select(expr(&quot;@.number + 2&quot;))
g.V().select(expr(&quot;@.number - 2&quot;))
g.V().select(expr(&quot;@.number * 2&quot;))
g.V().select(expr(&quot;@.number / 2&quot;))
g.V().select(expr(&quot;(@.number + 2) / 4 + (@.age * 10)&quot;)) //head节点的number和age属性都是整型

//通过expression实现指数运算
g.V().select(expr(&quot;@.number ^^ 3&quot;))
g.V().select(expr(&quot;@.number ^^ -3&quot;))

//where
g.V().where(out().count().is(gt(4)))

//dedup
g.V().out().dedup()
g.V().out().dedup().by(&quot;name&quot;)
g.V().as(&quot;a&quot;).out().dedup(&quot;a&quot;)
g.V().as(&quot;a&quot;).out().dedup(&quot;a&quot;).by(&quot;name&quot;)

//range
g.V().out().limit(100)
g.V().out().range(10, 20)

//TextP.*
g.V().has(&quot;attrName&quot;, TextP.containing(&quot;substr&quot;))
g.V().has(&quot;attrName&quot;, TextP.notContaining(&quot;substr&quot;))
g.V().has(&quot;attrName&quot;, TextP.startingWith(&quot;substr&quot;))
g.V().has(&quot;attrName&quot;, TextP.notStartingWith(&quot;substr&quot;))
g.V().has(&quot;attrName&quot;, TextP.endingWith(&quot;substr&quot;))
g.V().has(&quot;attrName&quot;, TextP.notEndingWith(&quot;substr&quot;))
</pre></div>
</div>
<ul class="simple">
<li><p>Map（映射），如：</p></li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//constant</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">contant</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">constant</span><span class="p">(</span><span class="s">&quot;aaa&quot;</span><span class="p">)</span><span class="w"></span>

<span class="c1">//id</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">id</span><span class="p">()</span><span class="w"></span>

<span class="c1">//label</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">label</span><span class="p">()</span><span class="w"></span>

<span class="c1">//otherV</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">bothE</span><span class="p">().</span><span class="na">otherV</span><span class="p">()</span><span class="w"></span>

<span class="c1">//as...select</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">).</span><span class="na">out</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">select</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">).</span><span class="na">out</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">).</span><span class="na">out</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="sc">&#39;c&#39;</span><span class="p">).</span><span class="na">select</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>FlatMap（多重映射），如：</p></li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span>//out/in/both
g.V().out()
g.V().in(&#39;knows&#39;)

//outE/inE/inV/outV
g.V().outE(&#39;knows&#39;).inV()
g.V().inE().bothV()

//path expansion (语法糖)
//找到所有从 `V()` 开始通过 `knows` 边类型向外扩展[2, 4)跳的所有简单路径（点不重复），并且只保存path的最末端点
g.V().out(&#39;2..4&#39;, &#39;knows&#39;).with(&#39;PATH_OPT&#39;, &#39;SIMPLE&#39;).with(&#39;RESULT_OPT&#39;, &#39;END_V&#39;).endV()
//找到所有从 `V()` 开始通过 `knows` 边类型向外扩展[2, 4)跳的所有任意路径（点可重复），并且只保存path的最末端点
g.V().out(&#39;2..4&#39;, &#39;knows&#39;).with(&#39;PATH_OPT&#39;, &#39;ARBITRARY&#39;).with(&#39;RESULT_OPT&#39;, &#39;ALL_V&#39;)

//properties
g.V().values(&quot;name&quot;)
g.V().valueMap() // 输出所有属性
g.V().valueMap(&quot;name&quot;)
g.V().valueMap(&quot;name&quot;, &quot;age&quot;)
</pre></div>
</div>
<ul class="simple">
<li><p>Aggregate（聚合），如：</p></li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//global count</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">count</span><span class="p">()</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">where</span><span class="p">(</span><span class="n">out</span><span class="p">().</span><span class="na">in</span><span class="p">().</span><span class="na">count</span><span class="p">().</span><span class="na">is</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"></span>

<span class="c1">//fold</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">fold</span><span class="p">()</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">values</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">fold</span><span class="p">()</span><span class="w"></span>

<span class="c1">//groupCount</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">groupCount</span><span class="p">()</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">values</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">groupCount</span><span class="p">()</span><span class="w"></span>

<span class="c1">//groupBy</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">group</span><span class="p">()</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">group</span><span class="p">().</span><span class="na">by</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">out</span><span class="p">().</span><span class="na">group</span><span class="p">().</span><span class="na">by</span><span class="p">().</span><span class="na">by</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span><span class="w"></span>

<span class="c1">//groupBy多个keys，并且为每个key设置别名</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">group</span><span class="p">().</span><span class="na">by</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">).</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">))</span><span class="w"></span>
<span class="c1">//groupBy多个values，并且为每个value设置别名</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">group</span><span class="p">().</span><span class="na">by</span><span class="p">().</span><span class="na">by</span><span class="p">(</span><span class="n">min</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;min&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">max</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;max&quot;</span><span class="p">))</span><span class="w"></span>

<span class="c1">//global max/min</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">values</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">).</span><span class="na">max</span><span class="p">()</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">values</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">).</span><span class="na">min</span><span class="p">()</span><span class="w"></span>

<span class="c1">//global sum</span><span class="w"></span>
<span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">values</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">).</span><span class="na">sum</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>Loop（循环），如：</p></li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">.</span><span class="na">V</span><span class="p">().</span><span class="na">match</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">__</span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">).</span><span class="na">out</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="sc">&#39;b&#39;</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">__</span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="sc">&#39;b&#39;</span><span class="p">).</span><span class="na">out</span><span class="p">().</span><span class="na">as</span><span class="p">(</span><span class="sc">&#39;c&#39;</span><span class="p">)</span><span class="w"></span>
<span class="p">).</span><span class="na">select</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>Limit（top K，即取前k个结果）。</p></li>
</ul>
</div>
<div class="section" id="id14">
<h3>已知限制<a class="headerlink" href="#id14" title="Permalink to this headline"></a></h3>
<p>GraphScope暂时不支持下列Gremlin操作（会逐步支持）：</p>
<ul class="simple">
<li><p>Repeat (可以通过path expansion语法糖实现)</p></li>
<li><p>path()/simplePath() (可以通过path expansion语法糖实现)</p></li>
<li><p>Local (基于集合的local计算，i.e. count(local), dedup(local), …)</p></li>
<li><p>Branch</p></li>
<li><p>Explain（查询计划解释）</p></li>
<li><p>Profile（查询执行性能分析）</p></li>
<li><p>Sack（自定义状态计算）</p></li>
<li><p>Subgraph（计算子图，目前实现了一个简化版本，支持抽取子图写入Vineyard存储）</p></li>
<li><p>Cap（访问自定义状态）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GraphComputer</span></code> 接口（例如PageRank和ShortestPath）；这部分功能GraphScope通过图分析引擎和NetworkX兼容接口提供。</p></li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="analytics_engine.html" class="btn btn-neutral float-left" title="图分析引擎" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="learning_engine.html" class="btn btn-neutral float-right" title="图学习引擎" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2023, DAMO Academy, Alibaba Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          

            
              
                <dd><a href="../../latest/zh/index.html">latest</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../zh/index.html">stable</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.17.0/zh/index.html">v0.17.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.16.0/zh/index.html">v0.16.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.15.0/zh/index.html">v0.15.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.14.0/zh/index.html">v0.14.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.13.0/zh/index.html">v0.13.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.12.0/zh/index.html">v0.12.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.11.0/zh/index.html">v0.11.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.10.1/zh/index.html">v0.10.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.10.0/zh/index.html">v0.10.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.9.1/zh/index.html">v0.9.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.9.0/zh/index.html">v0.9.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.8.0/zh/index.html">v0.8.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.7.0/zh/index.html">v0.7.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.6.1/zh/index.html">v0.6.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.6.0/zh/index.html">v0.6.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.5.0/zh/index.html">v0.5.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.4.1/zh/index.html">v0.4.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.4.0/zh/index.html">v0.4.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.3.0/zh/index.html">v0.3.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.2.1/zh/index.html">v0.2.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.2.0/zh/index.html">v0.2.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.1.3/zh/index.html">v0.1.3</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.1.2/zh/index.html">v0.1.2</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.1.1/zh/index.html">v0.1.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../v0.1.0/zh/index.html">v0.1.0</a></dd>
              
            

          
        
      </dl>
    </div>
  </div>

  <div class="rst-languages shift-up" role="note" aria-label="languages">
    <div class="rst-other-languages">
      <dl>
        <dt>Languages</dt>
        <dd><a href="../index.html">en</a></dd>
        <dd><a href="index.html">zh_CN</a></dd>
      </dl>

      <hr />
      <small>
        <span>Hosted by <a href="https://pages.github.com/">Github Pages</a>.</span>
      </small>
    </div>
  </div>


</body>
</html>