<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Graph Traversal &mdash; GraphScope  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4TMYCGJ0X2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4TMYCGJ0X2');
</script>

<script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?da649ade2298891886e31922dfc8870f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GraphScope
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div>
  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      
      
        
          
        
      
      
        <p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loading_graph.html">Loading Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graph_transformation.html">Graph Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analytics_engine.html">GraphScope Analytical Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interactive_engine.html">GraphScope Interactive Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../learning_engine.html">GraphScope Learning Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../persistent_graph_store.html">Persistent Graph Store</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../frequently_asked_questions.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python_index.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analytical_engine_index.html">Analytical Engine API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gae_java/index.html">Analytical Engine Java API Reference</a></li>
</ul>

      
    
  </div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GraphScope</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Graph Traversal</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/alibaba/graphscope/edit/main/docs/reference/gnn_engine/graph_traverse_en.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="graph-traversal">
<h1>Graph Traversal<a class="headerlink" href="#graph-traversal" title="Permalink to this headline"></a></h1>
<p># 1. Introduction The semantics of graph traversal in GNN is different
from classic graph computation. Training by batch is the characteristics
of mainstream deep learning alogrithms. Thus, to meet this requirement,
graph data must be able to access by batches. We denote this data access
pattern as graph traversal. In a GNN algorithm, the data source is the
graph and the training samples are comprised of vertices and edges.
Graph traversal refers to the approach of obtaining the training
vertices and edges in batch.</p>
<p>Currently, <strong>GL</strong> supports traversing graph by batch and such random
traversal could be with or without replacement. In the traversal without
replacement, the program will throw a <code class="docutils literal notranslate"><span class="pre">gl.OutOfRangeError</span></code> exception
when an epoch is finished. The data source to be traversed is
partitioned, which means each worker(e.g. distributed tensorflow) only
traverses the data on the corresponding Server.</p>
<p># 2. Vertex Traversal ## 2.1 Usages There are three type of data sources
for vertices: all unique vertices, source vertices of all edges and
destination vertices of all edges. Vertex traversal is implemented by
the <code class="docutils literal notranslate"><span class="pre">NodeSampler</span></code> operator. The <code class="docutils literal notranslate"><span class="pre">node_sampler()</span></code> API of <code class="docutils literal notranslate"><span class="pre">Graph</span></code>
object returns a <code class="docutils literal notranslate"><span class="pre">NodeSampler</span></code> object, and then invokes <code class="docutils literal notranslate"><span class="pre">get()</span></code> API
of this object to return <code class="docutils literal notranslate"><span class="pre">Nodes</span></code> data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">node_sampler</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;by_order&quot;</span><span class="p">,</span> <span class="n">node_from</span><span class="o">=</span><span class="n">gl</span><span class="o">.</span><span class="n">NODE</span><span class="p">):</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Args:</span>
<span class="sd">  type(string):     type=&quot;vertex&quot; when node_from=gl.NODE, otherwise type=&quot;edge&quot;;</span>
<span class="sd">  batch_size(int):  number of vertices in each traversal</span>
<span class="sd">  strategy(string):  can only take value from {&quot;by_order, &quot;random&quot;}.</span>
<span class="sd">      &quot;by_order&quot;: stands for traverse without replacements, the return number</span>
<span class="sd">          is the actual traversed count. A gl.OutOfRangeError will throw if</span>
<span class="sd">          the actual traversed count is 0 (i.e. when an epoch is finished);</span>
<span class="sd">      &quot;random&quot;: stands for random traverse.</span>
<span class="sd">  node_from: data source, can only take value from {gl.NODE、gl.EDGE_SRC、gl.EDGE_DST}</span>
<span class="sd">Return:</span>
<span class="sd">  NodeSampler object</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">NodeSampler</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Return:</span>
<span class="sd">    Nodes object, data shape=[batch_size] if current epoch isn&#39;t finished.</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>You can access specific values through the <code class="docutils literal notranslate"><span class="pre">Nodes</span></code> object, such as id,
weight, attribute and etc. Please refer to APIs
<a class="reference external" href="graph_query_cn.md#FPU74">API</a> for more details. And refer to
<code class="docutils literal notranslate"><span class="pre">g.V()</span></code> for vertex traversal in GSL.</p>
<p>## 2.2 Example | id | attributes | | — | — | | 10001 | 0:0.1:0
| | 10002 | 1:0.2:3 | | 10003 | 3:0.3:4 |</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node_sampler</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">int_attrs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">float_attrs</span><span class="p">)</span>
</pre></div>
</div>
<p># 3 Edge Traversal ## 3.1 Usages Edge traversal is implemented by the
<code class="docutils literal notranslate"><span class="pre">EdgeSampler</span></code> operation. The <code class="docutils literal notranslate"><span class="pre">edge_sampler()</span></code> API of <code class="docutils literal notranslate"><span class="pre">Graph</span></code>
object returns a <code class="docutils literal notranslate"><span class="pre">EdgeSampler</span></code> object, and then invokes <code class="docutils literal notranslate"><span class="pre">get()</span></code> API
of this object to return <code class="docutils literal notranslate"><span class="pre">Edges</span></code> data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">edge_sampler</span><span class="p">(</span><span class="n">edge_type</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;by_order&quot;</span><span class="p">):</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Args:</span>
<span class="sd">  edge_type(string): edge type</span>
<span class="sd">  batch_size(int):   number of edges in each traversal</span>
<span class="sd">  strategy(string):  can only take value from {&quot;by_order, &quot;random&quot;}.</span>
<span class="sd">      &quot;by_order&quot;: stands for traverse without replacements, the return number</span>
<span class="sd">          is the actual traversed count. A gl.OutOfRangeError will throw if</span>
<span class="sd">          the actual traversed count is 0 (i.e. when an epoch is finished);</span>
<span class="sd">      &quot;random&quot;: stands for random traverse.</span>
<span class="sd">Return:</span>
<span class="sd">  EdgeSampler object</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">EdgeSampler</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Return:</span>
<span class="sd">    Edges object, data shape=[batch_size] if current epoch isn&#39;t finished.</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>You can access specific values through the <code class="docutils literal notranslate"><span class="pre">Edges</span></code> object, such as id,
weight, attribute, etc. Please refer to
<a class="reference external" href="graph_query_cn.md#FPU74">API</a> for more details. And refer to
<code class="docutils literal notranslate"><span class="pre">g.E()</span></code> for edge traversal in GSL.</p>
<p>## 3.2 Example | src_id | dst_id | weight | attributes | | — | —
| — | — | | 20001 | 30001 | 0.1 |
0.10,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19 | | 20001 | 30003
| 0.2 | 0.20,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29 | | 20003
| 30001 | 0.3 | 0.30,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39 |
| 20004 | 30002 | 0.4 |
0.40,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49 |</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_sampler</span><span class="p">(</span><span class="s2">&quot;buy&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">src_ids</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">src_ids</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">float_attrs</span><span class="p">)</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2023, DAMO Academy, Alibaba Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          

            
              
                <dd><a href="../../../latest/index.html">latest</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../index.html">stable</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.17.0/index.html">v0.17.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.16.0/index.html">v0.16.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.15.0/index.html">v0.15.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.14.0/index.html">v0.14.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.13.0/index.html">v0.13.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.12.0/index.html">v0.12.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.11.0/index.html">v0.11.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.10.1/index.html">v0.10.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.10.0/index.html">v0.10.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.9.1/index.html">v0.9.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.9.0/index.html">v0.9.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.8.0/index.html">v0.8.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.7.0/index.html">v0.7.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.6.1/index.html">v0.6.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.6.0/index.html">v0.6.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.5.0/index.html">v0.5.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.4.1/index.html">v0.4.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.4.0/index.html">v0.4.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.3.0/index.html">v0.3.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.2.1/index.html">v0.2.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.2.0/index.html">v0.2.0</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.1.3/index.html">v0.1.3</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.1.2/index.html">v0.1.2</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.1.1/index.html">v0.1.1</a></dd>
              
            

          
        
          

            
              
                <dd><a href="../../../v0.1.0/index.html">v0.1.0</a></dd>
              
            

          
        
      </dl>
    </div>
  </div>

  <div class="rst-languages shift-up" role="note" aria-label="languages">
    <div class="rst-other-languages">
      <dl>
        <dt>Languages</dt>
        <dd><a href="../../index.html">en</a></dd>
        <dd><a href="../../zh/index.html">zh_CN</a></dd>
      </dl>

      <hr />
      <small>
        <span>Hosted by <a href="https://pages.github.com/">Github Pages</a>.</span>
      </small>
    </div>
  </div>


</body>
</html>