g.V().has('PERSON','id',$personId).out('KNOWS').fold().store('friends').unfold().in('HASCREATOR').hasLabel('POST').has('creationDate',inside($startDate,$endDate)).out('HASTAG').filter(__.in('HASTAG').hasLabel('POST').has('creationDate', lt($startDate)).out('HASCREATOR').where(within('friends')).count().is(0)).groupCount().unfold().order().by(select(values),decr).by(select(keys).values('name')).limit(10)